hgdistver
~~~~~~~~~

This module is a simple drop-in to support setup.py
in mercurial and git based projects.

Alternatively it can be a setup time requirement.

It extracts the last Tag as well as the distance to it in commits
from the scm, and uses these to calculate a version number

By default, it will increment the last component of the Version by one
and append .dev{distance}
in case the last component is .dev, the version will be unchanged

Tis requires always using all components in tags (i.e. 2.0.0 instead of 2.0)
to avoid misstakenly releasing higher version
(i.e. 2.1.devX instead of 2.0.1.devX)




It uses 4 strategies to archive its task:

1. try to directly ask hg for the tag/distance
2. try to infer it from the `.hg_archival.txt` file
3. try to read the exact version the cache file if it exists
4. try to read the exact version from the 'PKG-INFO' file
   as generated by `setup.py sdists` (this is a nasty abuse)

The most simple usage is::

    from setuptools import setup
    from hgdistver import get_version
    setup(
        ...,
        version=get_version(),
        ...,
    )

`get_version` takes the optional argument `cachefile`,
which causes it to store the version info in a python script instead
of abusing PKG-INFO from a sdist.


The setup requirement usage is::

    from setuptools import setup
    setup(
        ...,
        get_version_from_hg=True,
        setup_requires=['hgdistver'],
        ...,
    )

The requirement uses the setup argument cache_hg_version_to instead of cachefile.
